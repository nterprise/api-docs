{
  "type": "machine",
  "label": "Run Application",
  "goto": "complete",
  "options": {
    "application": {
      "application_id": "ace-ios",
      "platforms": [
        {
          "platform": "openbsd",
          "arch": "s390"
        },
        {
          "platform": "darwin",
          "arch": "ppc"
        },
        {
          "platform": "freebsd",
          "arch": "s390"
        }
      ]
    },
    "configuration": {
      "pairing_cert": "dGhpcyBpcyBub3QgYSBjZXJ0IGZpbGUganVzdCBhbiBleGFtcGxl",
      "pairing_key": "dGhpcyBpcyBub3QgYSBjZXJ0IGZpbGUganVzdCBhbiBleGFtcGxl",
      "restore_device": true,
      "automated_enrollment": false,
      "mdm": {
        "vendor": "Meraki",
        "console_url": "http://jamf.zones.com",
        "user": "NterpriseBob",
        "password": "aute",
        "tenant_code": "nterprise",
        "set_asset_tag": "$._entity.input_filter[?(@.key = 'asset-tag')]"
      },
      "field_mappings": [
        {
          "from": "model",
          "to": "$._entity.input_filter[?(@.key = 'serial-number')]"
        },
        {
          "from": "bat_capacity",
          "to": "$._entity.input_filter[?(@.key = 'serial-number')]"
        },
        {
          "from": "imei2",
          "to": "$._entity.input_filter[?(@.key = 'serial-number')]"
        },
        {
          "from": "bat_capacity",
          "to": "$._entity.input_filter[?(@.key = 'serial-number')]"
        },
        {
          "from": "missed_profiles",
          "to": "$._entity.input_filter[?(@.key = 'serial-number')]"
        }
      ],
      "wait_for_apps": [
        "com.apple.itunes"
      ],
      "wait_for_battery_charge": 14
    }
  },
  "goto-fail": "process-fail",
  "context": [
    {
      "key": "$.unit.status",
      "value": "true",
      "lock": true,
      "ignore": false
    },
    {
      "key": "$.unit.status",
      "value": "true",
      "lock": true,
      "ignore": true
    },
    {
      "key": "$.unit.status",
      "value": "Pending",
      "lock": true,
      "ignore": true
    },
    {
      "key": "$.unit.status",
      "value": "$.buzz",
      "lock": false,
      "ignore": true
    },
    {
      "key": "$.unit.status",
      "value": "Pending",
      "lock": true,
      "ignore": false
    }
  ],
  "onError": {
    "finally": {
      "goto": "failed",
      "actions": [
        {
          "type": "email",
          "options": {
            "to": "bob@example.com",
            "from": "alice@example.com"
          }
        },
        {
          "type": "email",
          "options": {
            "to": "bob@example.com",
            "from": "alice@example.com"
          }
        }
      ]
    },
    "retry": 4
  },
  "onComplete": {
    "actions": [
      {
        "type": "email",
        "options": {
          "to": "bob@example.com",
          "from": "alice@example.com"
        }
      },
      {
        "type": "email",
        "options": {
          "to": "bob@example.com",
          "from": "alice@example.com"
        }
      },
      {
        "type": "email",
        "options": {
          "to": "bob@example.com",
          "from": "alice@example.com"
        }
      },
      {
        "type": "email",
        "options": {
          "to": "bob@example.com",
          "from": "alice@example.com"
        }
      }
    ]
  }
}